import org.springframework.stereotype.Service;
import java.io.FileInputStream;
import java.security.KeyStore;
import java.security.cert.Certificate;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.List;

@Service
public class TrustStoreService {

    public List<String> getTrustStoreDetails() {
        List<String> details = new ArrayList<>();
        try {
            String trustStorePath = System.getProperty("javax.net.ssl.trustStore");
            String trustStorePassword = System.getProperty("javax.net.ssl.trustStorePassword");

            if (trustStorePath == null || trustStorePassword == null) {
                details.add("TrustStore properties are not set.");
                return details;
            }

            details.add("TrustStore Path: " + trustStorePath);

            KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
            try (FileInputStream fis = new FileInputStream(trustStorePath)) {
                trustStore.load(fis, trustStorePassword.toCharArray());
            }

            Enumeration<String> aliases = trustStore.aliases();
            while (aliases.hasMoreElements()) {
                String alias = aliases.nextElement();
                Certificate certificate = trustStore.getCertificate(alias);
                details.add("Alias: " + alias);
                details.add("Certificate: " + certificate.toString());
            }
        } catch (Exception e) {
            details.add("Error reading trust store: " + e.getMessage());
        }
        return details;
    }
}
